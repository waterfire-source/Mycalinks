# 買取受付（Purchase Reception）モジュール

## 概要
買取受付業務を管理するモジュール。顧客からの買取依頼受付、査定予約、買取ステータス管理などの受付フロー全体を実装。

## ディレクトリ構成
```
purchaseReception/
├── components/
│   ├── MobilePurchaseReceptionPage.tsx     # モバイル版受付画面
│   ├── PurchaseHeaderButtons.tsx           # ヘッダーボタン群
│   ├── PurchaseReceptionContainer.tsx      # 受付コンテナ
│   └── ScanButton.tsx                      # スキャンボタン
├── [TransactionID]/
│   └── purchase/
│       ├── components/
│       │   ├── DesktopPurchaseAppreciatePage.tsx  # デスクトップ査定画面
│       │   └── MobilePurchaseAppreciatePage.tsx   # モバイル査定画面
│       └── page.tsx                        # 査定ページ
└── page.tsx                                # メインページ
```

## 主要機能

### 1. 受付管理
- **受付登録**: 新規買取受付の作成
- **受付一覧**: 進行中の受付案件一覧表示
- **ステータス管理**: 受付→査定→契約→完了の状態遷移
- **優先度設定**: 急ぎ案件のマーキング

### 2. 顧客情報管理
- **顧客検索**: 過去の買取履歴から顧客検索
- **新規顧客登録**: 初回買取時の顧客情報入力
- **連絡先管理**: 電話番号、メールアドレス
- **来店予約**: 査定予約日時の設定

### 3. 商品事前登録
- **商品スキャン**: バーコード/QRコードによる商品特定
- **商品情報入力**: 手動での商品情報入力
- **画像撮影**: 商品状態の記録
- **概算査定**: 事前査定額の算出

### 4. 査定処理
- **詳細査定**: 商品の詳細状態確認
- **価格算出**: 相場データベースを基にした査定
- **査定履歴**: 過去の査定結果参照
- **査定レポート**: 査定結果の印刷・メール送信

## 技術仕様

### コンポーネント構成
```typescript
// レスポンシブ対応
{isMobile ? (
  <MobilePurchaseReceptionPage />
) : (
  <ContainerLayout title="買取受付一覧">
    <PurchaseReceptionContainer />
  </ContainerLayout>
)}
```

### 受付ステータス管理
```typescript
enum PurchaseStatus {
  RECEPTION = 'reception',      // 受付中
  APPRAISAL = 'appraisal',     // 査定中
  NEGOTIATION = 'negotiation', // 交渉中
  CONTRACT = 'contract',       // 契約済み
  COMPLETED = 'completed',     // 完了
  CANCELLED = 'cancelled'      // キャンセル
}
```

### API連携
- `/api/purchase/reception/list`: 受付一覧取得
- `/api/purchase/reception/create`: 新規受付作成
- `/api/purchase/reception/update`: 受付情報更新
- `/api/purchase/appraisal/start`: 査定開始

## UI/UX設計

### デスクトップ版レイアウト
```
┌─────────────────────────────────────────────┐
│ 買取受付一覧 [設定] [新規受付] [スキャン]     │
├─────────────────────────────────────────────┤
│ 受付ID │ 顧客名 │ 受付日 │ ステータス │ 操作 │
├─────────────────────────────────────────────┤
│ R001   │ 田中太郎│ 今日   │ 査定中   │ [詳細]│
│ R002   │ 佐藤花子│ 昨日   │ 受付中   │ [詳細]│
│ R003   │ 山田一郎│ 2日前  │ 契約済み │ [詳細]│
└─────────────────────────────────────────────┘
```

### モバイル版レイアウト
- カード形式での受付情報表示
- スワイプ操作でのステータス変更
- タッチ操作最適化

## 受付フロー

### 1. 受付登録
1. 顧客来店・買取相談
2. 顧客情報確認/新規登録
3. 買取希望商品の概要聞き取り
4. 受付番号発行

### 2. 事前査定
1. 商品の基本情報入力
2. 外観状態の確認
3. 概算査定額の算出
4. 査定予約日時の設定

### 3. 詳細査定
1. 商品の詳細チェック
2. 動作確認・機能テスト
3. 市場価格との比較
4. 最終査定額の決定

### 4. 契約・完了
1. 査定結果の説明
2. 買取価格の合意
3. 契約書作成・署名
4. 買取完了・支払い

## 買取設定機能
- **買取条件設定**: 最低買取価格、手数料率
- **査定基準設定**: 状態評価基準の設定
- **通知設定**: 査定完了時の顧客通知
- **レポート設定**: 日次・月次レポート生成

## 権限管理
- **受付担当者**: 受付登録・基本情報入力
- **査定担当者**: 査定実施・価格決定
- **契約担当者**: 契約締結・支払い処理
- **管理者**: 全機能・設定変更

## パフォーマンス最適化
- 受付一覧の仮想スクロール
- 査定データのキャッシュ
- 画像の遅延読み込み
- バックグラウンド同期

## エラーハンドリング
- 受付登録失敗時の復旧
- 査定データ消失防止
- ネットワーク切断時の対応
- 重複受付の防止

## セキュリティ考慮事項
- 顧客情報の暗号化
- アクセスログの記録
- 権限に基づく機能制限
- 個人情報の適切な管理

## 関連モジュール
- `/purchase`: 買取処理
- `/purchaseTable`: 買取表管理
- `/customer`: 顧客管理
- `/appraisal`: 査定マスタ
- `/notification`: 通知機能