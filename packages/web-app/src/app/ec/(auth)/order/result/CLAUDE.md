# EC注文結果ディレクトリ

## 目的
注文完了後の結果表示機能を提供するディレクトリ構造

## 機能概要
- **ディレクトリ構造**: 注文結果関連ページの組織化
- **動的ルーティング**: [id]による個別注文結果表示
- **階層設計**: 注文結果機能の論理的な分離

## ディレクトリ構造詳細

### 現在の構成
```
packages/web-app/src/app/ec/(auth)/order/result/
├── CLAUDE.md              # 本ドキュメント
└── [id]/                  # 個別注文結果詳細
    └── page.tsx           # 注文結果詳細画面（251行）
```

### 設計思想
- **階層分離**: 注文結果機能の明確な分離
- **拡張性**: 将来的な機能追加への対応
- **Next.js App Router**: 動的ルーティングの活用

## 技術的特徴

### ルーティング設計
```typescript
// 動的ルーティング構造
/ec/(auth)/order/result/[id]  → 個別注文結果詳細

// 想定される将来の拡張
/ec/(auth)/order/result/      → 注文結果一覧（未実装）
/ec/(auth)/order/result/pdf/  → PDF生成（未実装）
```

### 現在の実装状況
- **実装済み**: [id]/page.tsx - 個別注文結果詳細
- **未実装**: ディレクトリレベルのpage.tsx
- **将来計画**: 一覧表示・PDF生成等の機能拡張

## 含まれる機能

### [id]/page.tsx (251行)
- **注文完了確認**: 注文確定メッセージ・確認メール案内
- **注文詳細表示**: 注文ID指定による個別注文情報表示
- **お届け先情報**: アカウント情報からの配送先表示
- **支払い方法表示**: 選択された決済方法の確認
- **商品情報表示**: StoreCard による店舗別商品一覧

## データフロー
```
注文確認・決済画面 → 注文処理 → 【result/[id]】 → 注文履歴
                                      ↑
                                 現在の位置
```

## 依存関係
- **useAppAuth**: アカウント情報取得
- **useEcOrder**: 注文データ取得
- **StatusIcon**: 進行状況表示（ステップ3/3）
- **StoreCard**: 店舗別商品表示
- **paymentMethods**: 決済方法マッピング

## 設計上の考慮事項

### ディレクトリレベルの機能不在
- **現状**: ディレクトリ直下にpage.tsxが存在しない
- **影響**: `/result/` へのアクセス時は404エラー
- **対応**: 必要に応じて一覧ページの実装を検討

### 拡張可能性
```typescript
// 将来的な機能拡張例
result/
├── page.tsx              # 注文結果一覧
├── [id]/
│   ├── page.tsx          # 詳細表示（現在実装済み）
│   ├── pdf/              # PDF生成
│   └── receipt/          # 領収書表示
├── search/               # 検索機能
└── export/               # エクスポート機能
```

## 関連システム
- **注文処理**: 決済完了後の自動遷移
- **メール通知**: 注文確認メール送信
- **注文履歴**: 履歴データとの整合性
- **アカウント管理**: 配送先情報との連携

## 開発上の注意点
- **URL設計**: resultディレクトリへの直接アクセス対応
- **エラーハンドリング**: 無効な注文IDへの対応
- **セキュリティ**: 他ユーザーの注文結果アクセス防止
- **パフォーマンス**: 注文データ取得の最適化

## 改善提案
- **一覧ページ**: 最近の注文結果一覧表示
- **検索機能**: 注文番号・日付による検索
- **フィルタリング**: ステータス・期間による絞り込み
- **エクスポート**: CSV・PDF出力機能

## 関連ファイル
- `[id]/page.tsx`: 注文結果詳細画面
- `../page.tsx`: 注文確認・決済画面（遷移元）
- `../history/`: 注文履歴機能
- `@/app/ec/(core)/components/cards/StoreCard`: 商品表示コンポーネント

---
*生成: 2025-01-24 / 項目46 - EC注文結果ディレクトリ* 