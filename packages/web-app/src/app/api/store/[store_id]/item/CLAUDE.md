# item/CLAUDE.md

## ğŸ¯ ç›®çš„ãƒ»å½¹å‰²

åº—èˆ—åˆ¥å•†å“ç®¡ç†API - å•†å“ãƒã‚¹ã‚¿ã®ç™»éŒ²ãƒ»æ›´æ–°ãƒ»å‰Šé™¤ã€åœ¨åº«ç®¡ç†ã€ä¾¡æ ¼è¨­å®šã€å•†å“æ¤œç´¢æ©Ÿèƒ½ã‚’æä¾›ã™ã‚‹åº—èˆ—å›ºæœ‰ã®APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã€‚POSã‚·ã‚¹ãƒ†ãƒ ã®å•†å“ç®¡ç†ã®ä¸­æ ¸ã‚’æ‹…ã†ã€‚

## ğŸ—ï¸ æŠ€è¡“æ§‹æˆ

- **ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯**: Next.js 14 API Routes
- **èªè¨¼**: NextAuth.js (åº—èˆ—åˆ¥ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡)
- **ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³**: Zod ã‚¹ã‚­ãƒ¼ãƒ
- **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹**: Prisma ORM + MySQL
- **ã‚­ãƒ£ãƒƒã‚·ãƒ¥**: Redis (å•†å“æ¤œç´¢çµæœ)
- **ãƒ•ã‚¡ã‚¤ãƒ«å‡¦ç†**: AWS S3 (å•†å“ç”»åƒ)
- **ä¾å­˜é–¢ä¿‚**: backend-core/services/item

## ğŸ“ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ 

```
item/
â”œâ”€â”€ route.ts                    # ãƒ¡ã‚¤ãƒ³APIãƒ«ãƒ¼ãƒˆ (26KB, 840è¡Œ)
â”œâ”€â”€ [item_id]/
â”‚   â”œâ”€â”€ route.ts               # å€‹åˆ¥å•†å“æ“ä½œ
â”‚   â”œâ”€â”€ stock/
â”‚   â”‚   â””â”€â”€ route.ts           # åœ¨åº«æ“ä½œ
â”‚   â”œâ”€â”€ price/
â”‚   â”‚   â””â”€â”€ route.ts           # ä¾¡æ ¼è¨­å®š
â”‚   â””â”€â”€ images/
â”‚       â””â”€â”€ route.ts           # ç”»åƒç®¡ç†
â”œâ”€â”€ search/
â”‚   â””â”€â”€ route.ts               # å•†å“æ¤œç´¢
â”œâ”€â”€ bulk/
â”‚   â””â”€â”€ route.ts               # ä¸€æ‹¬æ“ä½œ
â””â”€â”€ categories/
    â””â”€â”€ route.ts               # ã‚«ãƒ†ã‚´ãƒªåˆ¥å–å¾—
```

## ğŸ”§ ä¸»è¦æ©Ÿèƒ½

### å•†å“CRUDæ“ä½œ
- **POST /api/store/[store_id]/item**: æ–°è¦å•†å“ç™»éŒ²
- **GET /api/store/[store_id]/item**: å•†å“ä¸€è¦§å–å¾—
- **PUT /api/store/[store_id]/item/[item_id]**: å•†å“æƒ…å ±æ›´æ–°
- **DELETE /api/store/[store_id]/item/[item_id]**: å•†å“å‰Šé™¤

### åœ¨åº«ç®¡ç†
- **POST /api/store/[store_id]/item/[item_id]/stock**: åœ¨åº«èª¿æ•´
- **GET /api/store/[store_id]/item/[item_id]/stock**: åœ¨åº«å±¥æ­´å–å¾—
- **PUT /api/store/[store_id]/item/[item_id]/stock**: åœ¨åº«æ•°æ›´æ–°

### ä¾¡æ ¼ç®¡ç†
- **PUT /api/store/[store_id]/item/[item_id]/price**: ä¾¡æ ¼è¨­å®š
- **GET /api/store/[store_id]/item/[item_id]/price/history**: ä¾¡æ ¼å±¥æ­´

### å•†å“æ¤œç´¢ãƒ»ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
- **GET /api/store/[store_id]/item/search**: é«˜åº¦æ¤œç´¢
- **GET /api/store/[store_id]/item/categories**: ã‚«ãƒ†ã‚´ãƒªåˆ¥å–å¾—
- **GET /api/store/[store_id]/item/bulk**: ä¸€æ‹¬æ“ä½œ

## ğŸ’¡ ä½¿ç”¨ãƒ‘ã‚¿ãƒ¼ãƒ³

### å•†å“ç™»éŒ²
```typescript
// POST /api/store/123/item
const newItem = {
  name: "å•†å“å",
  category_id: 1,
  price: 1000,
  cost: 800,
  stock_quantity: 10,
  description: "å•†å“èª¬æ˜",
  images: ["image1.jpg", "image2.jpg"]
}
```

### å•†å“æ¤œç´¢
```typescript
// GET /api/store/123/item/search?q=å•†å“å&category=1&min_price=100&max_price=1000
const searchParams = {
  q: "æ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰",
  category: 1,
  min_price: 100,
  max_price: 1000,
  in_stock: true,
  page: 1,
  limit: 20
}
```

### åœ¨åº«èª¿æ•´
```typescript
// POST /api/store/123/item/456/stock
const stockAdjustment = {
  adjustment_type: "increase", // increase, decrease, set
  quantity: 5,
  reason: "å…¥è·",
  memo: "å®šæœŸå…¥è·åˆ†"
}
```

## ğŸ—ºï¸ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå†…ã§ã®ä½ç½®ã¥ã‘

- **ä¸Šä½å±¤**: åº—èˆ—APIçµ±æ‹¬ (`/api/store/[store_id]/`)
- **åŒä½å±¤**: å–å¼•APIã€é¡§å®¢APIã€åœ¨åº«API
- **ä¸‹ä½å±¤**: å•†å“è©³ç´°æ“ä½œã€åœ¨åº«å±¥æ­´ã€ä¾¡æ ¼å±¥æ­´
- **é€£æºå…ˆ**: backend-core/services/itemã€Redis ã‚­ãƒ£ãƒƒã‚·ãƒ¥

## ğŸ”— é–¢é€£ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª

- [../](../) - åº—èˆ—APIçµ±æ‹¬
- [../product/](../product/) - è£½å“ç®¡ç†API
- [../inventory/](../inventory/) - åœ¨åº«ç®¡ç†API
- [../transaction/](../transaction/) - å–å¼•API
- [../../../../feature/item/](../../../../feature/item/) - å•†å“ç®¡ç†UI
- [../../../../../backend-core/src/services/item/](../../../../../backend-core/src/services/item/) - ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯

## ğŸ“š ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒ»ãƒªã‚½ãƒ¼ã‚¹

- Prisma Item Schema å®šç¾©
- å•†å“ç®¡ç†æ¥­å‹™ãƒ•ãƒ­ãƒ¼å›³
- åœ¨åº«ç®¡ç†ãƒ«ãƒ¼ãƒ«ä»•æ§˜æ›¸
- ä¾¡æ ¼è¨­å®šãƒãƒªã‚·ãƒ¼

## ğŸ“ é–‹ç™ºãƒ¡ãƒ¢

### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è€ƒæ…®äº‹é …
- å•†å“æ¤œç´¢çµæœã®Redisã‚­ãƒ£ãƒƒã‚·ãƒ¥ (TTL: 5åˆ†)
- ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã®éåŒæœŸå‡¦ç†
- å¤§é‡å•†å“ä¸€è¦§ã®ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³å¿…é ˆ
- ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹æœ€é©åŒ– (name, category_id, store_id)

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ³¨æ„ç‚¹
- store_id ã«ã‚ˆã‚‹å³å¯†ãªãƒ‡ãƒ¼ã‚¿åˆ†é›¢
- å•†å“ç”»åƒã®ãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼ãƒ»ã‚µã‚¤ã‚ºåˆ¶é™
- ä¾¡æ ¼æƒ…å ±ã®å¤‰æ›´å±¥æ­´è¨˜éŒ²
- åœ¨åº«èª¿æ•´ã®æ¨©é™ãƒã‚§ãƒƒã‚¯

### ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹
- å•†å“ã‚³ãƒ¼ãƒ‰ã®é‡è¤‡ãƒã‚§ãƒƒã‚¯
- åœ¨åº«ãƒã‚¤ãƒŠã‚¹å€¤ã®åˆ¶å¾¡
- ä¾¡æ ¼å¤‰æ›´æ™‚ã®å½±éŸ¿ç¯„å›²ç¢ºèª
- å•†å“å‰Šé™¤æ™‚ã®å–å¼•å±¥æ­´ä¿æŒ

### æ³¨æ„äº‹é …
- å•†å“å‰Šé™¤ã¯è«–ç†å‰Šé™¤ã®ã¿
- åœ¨åº«èª¿æ•´ã¯å¿…ãšå±¥æ­´è¨˜éŒ²
- ä¾¡æ ¼å¤‰æ›´ã¯å³åº§ã«åæ˜ 
- ç”»åƒå‰Šé™¤æ™‚ã®S3ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—

### å°†æ¥ã®æ‹¡å¼µè¨ˆç”»
- ãƒãƒ¼ã‚³ãƒ¼ãƒ‰/QRã‚³ãƒ¼ãƒ‰å¯¾å¿œ
- å•†å“ãƒ¬ã‚³ãƒ¡ãƒ³ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³æ©Ÿèƒ½
- è‡ªå‹•ç™ºæ³¨æ©Ÿèƒ½
- å•†å“åˆ†æãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰

---
*Backend-Agentä½œæˆ: 2025-01-24* 