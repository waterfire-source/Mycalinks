### **プロジェクト：戦略的ドキュメント基盤構築 (`CLAUDE.md`配置計画)**

#### **統括責任者**: `Architect-Agent`
#### **参加エージェント**: `Architect-Agent` (他エージェントはタスク003以降で参加)
#### **関連ルール**: `@contextcatchup.mdc`, `@taskmanagement.mdc`

---

### **タスク1：【調査フェーズ】プロジェクト構造の反復的分析とレポート更新**

**ID**: `CLAUDE-TASK-001`
**カテゴリ**: `docs`
**タスク名**: プロジェクト構造の反復的分析とレポート更新
**状態**: `pending`
**優先度**: `high`
**複雑度**: `high`
**担当エージェント**: `Architect-Agent`
**ファイルスコープ**: プロジェクト全体(Read-Only), `tasks/project_analysis_report.md`(Read/Write)

**説明**:
大規模プロジェクトの完全なディレクトリ構造を把握するため、**反復的な調査とユーザーとの対話**を通じて、単一の調査レポートファイルを段階的に更新・完成させる。AIのコンテキストがリセットされても、このレポートファイルを参照することでいつでも調査を再開できる状態を目指す。

**担当範囲（明確な境界定義）**:
- `tasks/project_analysis_report.md`という単一の成果物を作成し、更新し続ける責任を持つ。
- 各反復処理では、レポートファイルを読み込み、ユーザーの指示に従って新たな調査結果を追記し、ファイルを上書き保存する。

**ファイル・ディレクトリ割り当て**:
- **成果物**: `tasks/project_analysis_report.md`
- **調査対象**: プロジェクト全体のディレクトリ

**受け入れ基準（チェックリスト）**:
- [ ] 1. **初期化・優先度スキャン**: `tasks/project_analysis_report.md`が存在しない場合、新規作成する。まずプロジェクト全体のディレクトリ構造を**浅くスキャン**し、**最も重要度が高いと推測されるディレクトリTOP3**（例: `src/`, `src-tauri/`, `packages/`）を特定する。その3つについてのみ初期分析を行い、レポートに書き込む。
- [ ] 2. **状態復元**: `tasks/project_analysis_report.md`が**存在する場合**、まずその内容を完全に読み込み、現在の調査状況（既に分析済みのパス、CLAUDE.md配置確定リスト）を把握する。
- [ ] 3. **ユーザー対話**: レポートの現状をユーザーに提示し、次のアクション（深掘り/配置確定/完了）を仰ぐ。
- [ ] 4. **深掘り・次候補の提案**: ユーザーから深掘りの指示があったディレクトリを分析する。その際、**次に調査すべき重要度の高いディレクトリ候補**も併せて推測し、ユーザーに提案する。
- [ ] 5. **配置確定**: ユーザーから配置確定の指示があった場合、レポートファイル内の「CLAUDE.md配置確定リスト」セクションを**更新**する。
- [ ] 6. **ループ**: ユーザーが「調査完了」を指示するか、**調査すべき重要ディレクトリがなくなる**まで、ステップ2から5を繰り返す。
- [ ] 7. **完了**: ユーザーが「調査完了」を指示したら、完成した`tasks/project_analysis_report.md`を最終成果物としてこのタスクを完了する。

実装詳細（チェックリスト）:
- [ ] **`tasks/project_analysis_report.md` の構造を定義する:**
    - セクション1: `## 調査状況サマリー` (最終更新日時、次の調査候補など)
    - セクション2: `## CLAUDE.md 配置確定リスト` (ユーザーによって確定されたパスのリスト)
    - セクション3: `## ディレクトリ分析詳細` (各階層の分析結果をツリー形式で記述)
- [ ] **調査実行時の戦略とルールを定義する:**
    - **`contextcatchup.mdc`の`ignore_patterns`を厳密に適用する。** ... (変更なし)
    - 上記に加え、プロジェクト固有のキャッシュやレポートディレクトリ... (変更なし)
    - **探索戦略は「重要度ベース」とする。** 機械的に全ディレクトリを探索するのではなく、以下のヒューリスティクスに基づいて次に調査すべき最も可能性の高いディレクトリを判断する。
        - **命名規則:** `src`, `app`, `core`, `services`, `api` といった名前を持つディレクトリを優先する。
        - **設定ファイルの存在:** `package.json`, `Cargo.toml`, `pyproject.toml` など、中核となる設定ファイルを含むディレクトリの重要度を上げる。
        - **ユーザーの指示:** ユーザーが深掘りを指示したディレクトリは最優先で調査する。
    - ユーザーへの提案時には、常に「次に調査すべき推奨ディレクトリ」を明示し、調査の主導権をユーザーに委ねること。
- [ ] ユーザーへの提示は、常にレポートファイルの内容を要約・表示する形で行う。

**他エージェントとの調整点**:
- このタスクは`Architect-Agent`が単独で実行する。他エージェントは待機。

---

### **タスク2：【合意形成フェーズ】最終配置リストの承認**

**(前回の提案から変更なし)**
**ID**: `CLAUDE-TASK-002`
**カテゴリ**: `docs`
**タスク名**: `CLAUDE.md`最終配置ディレクトリリストの承認
**状態**: `pending`
**優先度**: `high`
**複雑度**: `low`
**担当エージェント**: `Architect-Agent`
**ファイルスコープ**: `tasks/project_analysis_report.md`(Read-Only)

**説明**:
完了した`CLAUDE-TASK-001`の成果物である`tasks/project_analysis_report.md`を読み込み、その中の「CLAUDE.md配置確定リスト」をユーザーに提示して最終承認を得る。

**依存関係**:
- **requires**: `CLAUDE-TASK-001`

**受け入れ基準（チェックリスト）**:
- [ ] 1. `tasks/project_analysis_report.md`を読み込み、「CLAUDE.md配置確定リスト」を抽出する。
- [ ] 2. 抽出したリストをユーザーに提示し、最終承認を求める。
- [ ] 3. 承認が得られたら、このタスクを完了し、承認済みリストを`CLAUDE-TASK-003`に引き渡す。

---

### **タスク3：【実行フェーズ】`CLAUDE.md`作成タスクの分割と割り当て**

**(前回の提案から変更なし)**
**ID**: `CLAUDE-TASK-003`
**カテゴリ**: `multi_agent`
**タスク名**: `CLAUDE.md`作成タスクの分割とエージェントへの割り当て
**状態**: `pending`
**優先度**: `high`
**複雑度**: `medium`
**担当エージェント**: `Architect-Agent` (統括責任者)
**ファイルスコープ**: `tasks/`(Read/Write)

**説明**:
`CLAUDE-TASK-002`で承認された最終配置リストに基づき、`@taskmanagement.mdc`のルールに従って具体的なサブタスクファイル群 (`TASK-xxx.md`, `TASK-xxx.md`...)と、進捗管理用の`tasks/INDEX.md`を生成もしくは編集する。

**依存関係**:
- **requires**: `CLAUDE-TASK-002`

**受け入れ基準（チェックリスト）**:
- [ ] 1. 承認済みリスト内の各ディレクトリに対し、個別サブタスクを`tasks/TASK-XXX.md`として生成する。
- [ ] 2. 各サブタスクを専門分野に応じて`Frontend/Backend/DevOps-Agent`に割り当てる。
- [ ] 3. `tasks/INDEX.md`を作成・更新し、全サブタスクを一覧化する。
- [ ] 4. 各担当エージェントに作業開始を通知し、このタスクを完了する。